# PyBook

This project has a few parts.

First part is a containerized build of Python inside emscripten. This allows running Python in the browser locally.

The version here has a few tweaks to allow better integration of the Python interpreter with the web environment. Most
notably, it has tweaks to allow keyboard interrupt using a JavaScript callback function inside the main interpreter loop.
This replaces control-C style interrupts which are not generated by the emscripten environment.

The interpreter can also dynamically load python modules.

Second big part is a notebook interface using the kernel to allow Python notebooks similar to Mathematica.

## Developing

If things are in a good state, you should be able to do:

    make

This should create a container, build Python in emscripten, build necessary libraries and tools, and package everything
in the `build` directory.

To run PyBook in your browser, do:

    make serve

It will start a mini server, in a browser go to `localhost:8063/pybook.html`.

## PyBook UI

You have cells, cells can be Python code or Markdown. To run Python code, use "Control-Enter".
Output from the evaluation will be shown after a small right arrow. Things printed to `stdout` will appear before the evaluated output.

For PyBook, even if the expression evaluates to `None` that will be shown with the arrow. This is a slight difference from the
command-line Python interpreter.

Note that when you import modules, you may be sending requests to the web server.

## Features

### Status Lights

There are three lights showing kernel status.

First is kernel active. This lights up when the main interpreter loop is active doing something.

Second is loading. This lights up when files are being loaded, which normally happens when modules are imported.

Third is bootup. This lights up when the kernel is first started up, and turns off when the kernel is ready.

Example that shows loading (first time evaluated):

    import png
    help(png)

### Sleep

You can do `time.sleep` to delay in Python. This should not break the browser. The Python kernel itself is not multi-threaded, so if you start evaluating one cell and it sleeps, you will need to interrupt it to evaluate more cells in other positions.

Example:

    import time
    for i in range(10):
        print(i)
        time.sleep(1)

### Interrupt

Press "Control-C" to interrupt computation or sleep in a cell. This should normally generate a `KeyboardInterrupt` exception. If you catch this exception and don't exit it is possible to lockup the Python kernel.

### PyBook Module

There is a special Python module `pybook` that has functions to interact with the notebook. This lets you write Python code to generate images or HTML or whatever you want.

Example:

    import pybook
    pybook.output_text_content("text/html", "<b>Hello</b>")
