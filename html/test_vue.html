<!DOCTYPE html>
<html>
<head>
<title>Test of VueJS Notebook</title>
<script defer src="codemirror/codemirror.js"></script>
<link rel="stylesheet" href="codemirror/codemirror.css">
<script defer src="codemirror/python.js"></script>
<style>
.cell {
    border: 1px solid #000;
}
.codemirror {
    border: 1px solid #000;
}
.output {
    background-color: #fffcfa;
    border: 2px solid #888;
    height: auto;
}
.evaloutput {
    background-color: #fafcff;
    border: 2px solid #888;
    height: auto;
}
.stdout {
}
.stderr {
    background-color: #ff0;
}
.eval {
}
pre {
    white-space: pre-wrap;
    word-break: break-all;
    margin: 0;
}

</style>
</head>
<body>


<div id="app">
    {{ message }}
    <codemirror
        v-model:value="txt"
        v-bind:options="opts"
        v-bind:startvalue="txt"
    ></codemirror>
</div>

<!-- development version, includes helpful console warnings -->
<!-- 
<script defer src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
-->

<script defer src="vue.js"></script>

<script>

function onready(f) {
    if (window.onload) {
        var curronload = window.onload;
        var newonload = function(evt) {
            curronload(evt);
            f(evt);
        };
        window.onload = newonload;
    } else {
        window.onload = f;
    }
}

onready(function() {
    Vue.component('codemirror', {
        data: function() {
            return {
                value: this.startvalue,
            };
        },
        props: ['options', 'startvalue'],
        template: String.raw`
            <div class="codemirror">
                <textarea></textarea>
            </div>
`,
        mounted: function() {
            var self = this;
            var elem = self.$el.querySelector('textarea');
            self.editor = CodeMirror.fromTextArea(elem, self.options);
            self.editor.setValue(self.value || '');
            self.editor.on('change', function(cm) {
                self.value = cm.getValue();
                self.$emit('change', self.value);
                self.$emit('input', self.value);
            });
        },
        watch: {
            value: function(v) {
                var currentValue = this.editor.getValue();
                if (currentValue !== v) {
                    this.editor.setValue(v);
                }
            },
        },
    });
    var app = new Vue({
        el: '#app',
        data: {
            message: 'Hello world',
            txt: 'input text',
            opts: { lineNumbers: true },
        }
    });
    window.app = app;
});

</script>
</body>
</html>
